{"version":3,"file":"CopyToClipboard.js","sourceRoot":"../../../../src","sources":["components/CopyToClipboard/CopyToClipboard.tsx"],"names":[],"mappings":"AAAA,YAAY,CAAC;AAEb,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAE/B,OAAO,EAAC,QAAQ,EAAC,sBAAmB;AAGpC,MAAM,cAAc,GAA0B,SAAS,CAAC;AAExD,MAAM,UAAU,eAAe,CAAC,KAA2B;IACvD,MAAM,EAAC,QAAQ,EAAE,IAAI,EAAE,OAAO,EAAE,MAAM,EAAC,GAAG,KAAK,CAAC;IAEhD,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;IACjC,MAAM,CAAC,MAAM,EAAE,SAAS,CAAC,GAAG,KAAK,CAAC,QAAQ,CAAwB,cAAc,CAAC,CAAC;IAElF,MAAM,UAAU,GAAG,KAAK,CAAC,MAAM,EAAU,CAAC;IAE1C,MAAM,OAAO,GACT,OAAO,QAAQ,KAAK,UAAU,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;IAEjE,MAAM,UAAU,GAAG,KAAK,CAAC,WAAW,CAChC,CAAC,QAAgB,EAAE,MAAe,EAAE,EAAE;QAClC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;QACxC,MAAM,CAAC,YAAY,CAAC,UAAU,CAAC,OAAO,CAAC,CAAC;QACxC,UAAU,CAAC,OAAO,GAAG,MAAM,CAAC,UAAU,CAAC,GAAG,EAAE,CAAC,SAAS,CAAC,cAAc,CAAC,EAAE,OAAO,CAAC,CAAC;QACjF,MAAM,EAAE,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;IAC/B,CAAC,EACD,CAAC,MAAM,EAAE,OAAO,CAAC,CACpB,CAAC;IAEF,MAAM,eAAe,GAAyC,KAAK,CAAC,WAAW,CAC3E,CAAC,KAAK,EAAE,EAAE;QACN,MAAM,WAAW,GAAG,OAAO,IAAI,KAAK,UAAU,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;QAC/D,OAAO,CAAC,OAAO,GAAG,WAAW,CAAC;QAE9B,SAAS,IAAI,CAAC,MAAe;YACzB,IAAI,WAAW,KAAK,OAAO,CAAC,OAAO,EAAE,CAAC;gBAClC,UAAU,CAAC,WAAW,EAAE,MAAM,CAAC,CAAC;gBAEhC,OAAO,CAAC,KAAK,EAAE,OAAO,EAAE,CAAC,KAAK,CAAC,CAAC;YACpC,CAAC;QACL,CAAC;QAED,QAAQ,CAAC,WAAW,CAAC,CAAC,IAAI,CACtB,GAAG,EAAE;YACD,IAAI,CAAC,IAAI,CAAC,CAAC;QACf,CAAC,EACD,GAAG,EAAE;YACD,IAAI,CAAC,KAAK,CAAC,CAAC;QAChB,CAAC,CACJ,CAAC;IACN,CAAC,EACD,CAAC,OAAO,CAAC,KAAK,EAAE,UAAU,EAAE,IAAI,CAAC,CACpC,CAAC;IAEF,KAAK,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,YAAY,CAAC,UAAU,CAAC,OAAO,CAAC,EAAE,EAAE,CAAC,CAAC;IAEzE,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,OAAO,CAAC,EAAE,CAAC;QACjC,MAAM,IAAI,KAAK,CAAC,uCAAuC,CAAC,CAAC;IAC7D,CAAC;IAED,OAAO,KAAK,CAAC,YAAY,CAAC,OAAO,EAAE;QAC/B,OAAO,EAAE,eAAe;KAC3B,CAAC,CAAC;AACP,CAAC","sourcesContent":["'use client';\n\nimport * as React from 'react';\n\nimport {copyText} from './copyText';\nimport type {CopyToClipboardProps, CopyToClipboardStatus} from './types';\n\nconst INITIAL_STATUS: CopyToClipboardStatus = 'pending';\n\nexport function CopyToClipboard(props: CopyToClipboardProps) {\n    const {children, text, timeout, onCopy} = props;\n\n    const textRef = React.useRef('');\n    const [status, setStatus] = React.useState<CopyToClipboardStatus>(INITIAL_STATUS);\n\n    const timerIdRef = React.useRef<number>();\n\n    const content: React.ReactElement<React.HTMLAttributes<HTMLElement>> =\n        typeof children === 'function' ? children(status) : children;\n\n    const handleCopy = React.useCallback(\n        (copyText: string, result: boolean) => {\n            setStatus(result ? 'success' : 'error');\n            window.clearTimeout(timerIdRef.current);\n            timerIdRef.current = window.setTimeout(() => setStatus(INITIAL_STATUS), timeout);\n            onCopy?.(copyText, result);\n        },\n        [onCopy, timeout],\n    );\n\n    const onClickWithCopy: React.MouseEventHandler<HTMLElement> = React.useCallback(\n        (event) => {\n            const currentText = typeof text === 'function' ? text() : text;\n            textRef.current = currentText;\n\n            function copy(result: boolean) {\n                if (currentText === textRef.current) {\n                    handleCopy(currentText, result);\n\n                    content.props?.onClick?.(event);\n                }\n            }\n\n            copyText(currentText).then(\n                () => {\n                    copy(true);\n                },\n                () => {\n                    copy(false);\n                },\n            );\n        },\n        [content.props, handleCopy, text],\n    );\n\n    React.useEffect(() => () => window.clearTimeout(timerIdRef.current), []);\n\n    if (!React.isValidElement(content)) {\n        throw new Error('Content must be a valid react element');\n    }\n\n    return React.cloneElement(content, {\n        onClick: onClickWithCopy,\n    });\n}\n"]}