{"version":3,"file":"useCollapseActions.js","sourceRoot":"../../../../../../src","sources":["components/ActionsPanel/components/hooks/useCollapseActions.ts"],"names":[],"mappings":"AAAA,YAAY,CAAC;;;;;AAEb,qDAA+B;AAI/B,gEAAwD;AACxD,wEAAgE;AAEhE,MAAM,0BAA0B,GAAG,CAAC,CAAC;AAE9B,MAAM,kBAAkB,GAAG,CAAC,OAA2B,EAAE,aAAsB,EAAE,EAAE;IACtF,MAAM,UAAU,GAAG,IAAI,CAAC,GAAG,CACvB,CAAC,EACD,OAAO,aAAa,KAAK,WAAW,CAAC,CAAC,CAAC,0BAA0B,CAAC,CAAC,CAAC,aAAa,CACpF,CAAC;IAEF,MAAM,mBAAmB,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE;QAC3C,OAAO,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,EAAE,EAAE,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IACvD,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;IAEd,MAAM,gBAAgB,GAAG,KAAK,CAAC,OAAO,CAClC,GAAG,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,EAAC,EAAE,EAAC,EAAE,EAAE,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG,UAAU,EACtD,CAAC,OAAO,EAAE,UAAU,CAAC,CACxB,CAAC;IAEF,MAAM,CAAC,aAAa,EAAE,WAAW,CAAC,GAAG,KAAK,CAAC,OAAO,CAAC,GAAG,EAAE;QACpD,MAAM,WAAW,GAAuB,EAAE,CAAC;QAC3C,MAAM,SAAS,GAAuB,EAAE,CAAC;QAEzC,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,EAAE;YACvB,IAAI,WAAW,CAAC,MAAM,GAAG,UAAU,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE,CAAC;gBACvD,WAAW,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC7B,CAAC;iBAAM,CAAC;gBACJ,SAAS,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;YAC3B,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,OAAO,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;IACpC,CAAC,EAAE,CAAC,OAAO,EAAE,UAAU,CAAC,CAAC,CAAC;IAE1B,MAAM,EAAC,SAAS,EAAE,aAAa,EAAE,MAAM,EAAC,GAAG,IAAA,+CAAsB,EAAC,gBAAgB,CAAC,CAAC;IAEpF,MAAM,aAAa,GAAG,IAAA,uCAAkB,EAAC,EAAC,aAAa,EAAE,WAAW,EAAE,aAAa,EAAC,CAAC,CAAC;IAEtF,MAAM,eAAe,GAAG,mBAAmB,IAAI,UAAU,KAAK,CAAC,CAAC;IAEhE,MAAM,YAAY,GACd,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,eAAe,CAAC,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,CAAC;IAE3F,OAAO;QACH,aAAa;QACb,aAAa;QACb,SAAS;QACT,MAAM,EAAE,eAAe,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,MAAM;QACpC,aAAa;QACb,YAAY;KACf,CAAC;AACN,CAAC,CAAC;AA/CW,QAAA,kBAAkB,sBA+C7B","sourcesContent":["'use client';\n\nimport * as React from 'react';\n\nimport type {ActionsPanelItem} from '../../types';\n\nimport {useDropdownActions} from './useDropdownActions';\nimport {useObserveIntersection} from './useObserveIntersection';\n\nconst DEFAULT_MAX_BUTTON_ACTIONS = 4;\n\nexport const useCollapseActions = (actions: ActionsPanelItem[], maxRowActions?: number) => {\n    const maxActions = Math.max(\n        0,\n        typeof maxRowActions === 'undefined' ? DEFAULT_MAX_BUTTON_ACTIONS : maxRowActions,\n    );\n\n    const allActionsCollapsed = React.useMemo(() => {\n        return actions.every((action) => action.collapsed);\n    }, [actions]);\n\n    const updateObserveKey = React.useMemo(\n        () => actions.map(({id}) => id).join('/') + maxActions,\n        [actions, maxActions],\n    );\n\n    const [buttonActions, restActions] = React.useMemo(() => {\n        const buttonItems: ActionsPanelItem[] = [];\n        const restItems: ActionsPanelItem[] = [];\n\n        actions.forEach((action) => {\n            if (buttonItems.length < maxActions && !action.collapsed) {\n                buttonItems.push(action);\n            } else {\n                restItems.push(action);\n            }\n        });\n\n        return [buttonItems, restItems];\n    }, [actions, maxActions]);\n\n    const {parentRef, visibilityMap, offset} = useObserveIntersection(updateObserveKey);\n\n    const dropdownItems = useDropdownActions({buttonActions, restActions, visibilityMap});\n\n    const isDefaultOffset = allActionsCollapsed || maxActions === 0;\n\n    const showDropdown =\n        (Object.keys(visibilityMap).length > 0 || isDefaultOffset) && dropdownItems.length > 0;\n\n    return {\n        buttonActions,\n        dropdownItems,\n        parentRef,\n        offset: isDefaultOffset ? 0 : offset,\n        visibilityMap,\n        showDropdown,\n    };\n};\n"]}